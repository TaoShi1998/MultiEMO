import torch
import torch.nn as nn




'''
Model Architecture of ResNet-101.
'''
class ResNet101(nn.Module):

    def __init__(self):
        super(ResNet101, self).__init__()

        self.meta = {'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225], 'image_size': [224, 224]}

        self.features_0 = nn.Conv2d(3, 64, kernel_size = [7, 7], stride = (2, 2), padding = (3, 3), bias = False) 
        self.features_1 = nn.BatchNorm2d(64, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_2 = nn.ReLU()
        self.features_3 = nn.MaxPool2d(kernel_size = (3, 3), stride = (2, 2), padding = (1, 1), dilation = (1, 1), ceil_mode = False)

        self.features_4_0_conv1 = nn.Conv2d(64, 64, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_4_0_bn1 = nn.BatchNorm2d(64, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_4_0_relu1 = nn.ReLU()
        self.features_4_0_conv2 = nn.Conv2d(64, 64, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_4_0_bn2 = nn.BatchNorm2d(64, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_4_0_relu2 = nn.ReLU()
        self.features_4_0_conv3 = nn.Conv2d(64, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_4_0_bn3 = nn.BatchNorm2d(256, eps=1e-05, momentum = 0.1, affine = True)
        self.features_4_0_downsample_0 = nn.Conv2d(64, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_4_0_downsample_1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_4_0_id_relu = nn.ReLU()
        self.features_4_1_conv1 = nn.Conv2d(256, 64, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_4_1_bn1 = nn.BatchNorm2d(64, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_4_1_relu1 = nn.ReLU()
        self.features_4_1_conv2 = nn.Conv2d(64, 64, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_4_1_bn2 = nn.BatchNorm2d(64, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_4_1_relu2 = nn.ReLU()
        self.features_4_1_conv3 = nn.Conv2d(64, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_4_1_bn3 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_4_1_id_relu = nn.ReLU()
        self.features_4_2_conv1 = nn.Conv2d(256, 64, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_4_2_bn1 = nn.BatchNorm2d(64, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_4_2_relu1 = nn.ReLU()
        self.features_4_2_conv2 = nn.Conv2d(64, 64, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_4_2_bn2 = nn.BatchNorm2d(64, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_4_2_relu2 = nn.ReLU()
        self.features_4_2_conv3 = nn.Conv2d(64, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_4_2_bn3 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_4_2_id_relu = nn.ReLU()

        self.features_5_0_conv1 = nn.Conv2d(256, 128, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_5_0_bn1 = nn.BatchNorm2d(128, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_5_0_relu1 = nn.ReLU()
        self.features_5_0_conv2 = nn.Conv2d(128, 128, kernel_size = [3, 3], stride = (2, 2), padding = (1, 1), bias = False)
        self.features_5_0_bn2 = nn.BatchNorm2d(128, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_5_0_relu2 = nn.ReLU()
        self.features_5_0_conv3 = nn.Conv2d(128, 512, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_5_0_bn3 = nn.BatchNorm2d(512, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_5_0_downsample_0 = nn.Conv2d(256, 512, kernel_size = [1, 1], stride = (2, 2), bias = False)
        self.features_5_0_downsample_1 = nn.BatchNorm2d(512, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_5_0_id_relu = nn.ReLU()
        self.features_5_1_conv1 = nn.Conv2d(512, 128, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_5_1_bn1 = nn.BatchNorm2d(128, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_5_1_relu1 = nn.ReLU()
        self.features_5_1_conv2 = nn.Conv2d(128, 128, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_5_1_bn2 = nn.BatchNorm2d(128, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_5_1_relu2 = nn.ReLU()
        self.features_5_1_conv3 = nn.Conv2d(128, 512, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_5_1_bn3 = nn.BatchNorm2d(512, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_5_1_id_relu = nn.ReLU()
        self.features_5_2_conv1 = nn.Conv2d(512, 128, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_5_2_bn1 = nn.BatchNorm2d(128, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_5_2_relu1 = nn.ReLU()
        self.features_5_2_conv2 = nn.Conv2d(128, 128, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_5_2_bn2 = nn.BatchNorm2d(128, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_5_2_relu2 = nn.ReLU()
        self.features_5_2_conv3 = nn.Conv2d(128, 512, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_5_2_bn3 = nn.BatchNorm2d(512, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_5_2_id_relu = nn.ReLU()
        self.features_5_3_conv1 = nn.Conv2d(512, 128, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_5_3_bn1 = nn.BatchNorm2d(128, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_5_3_relu1 = nn.ReLU()
        self.features_5_3_conv2 = nn.Conv2d(128, 128, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_5_3_bn2 = nn.BatchNorm2d(128, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_5_3_relu2 = nn.ReLU()
        self.features_5_3_conv3 = nn.Conv2d(128, 512, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_5_3_bn3 = nn.BatchNorm2d(512, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_5_3_id_relu = nn.ReLU()

        self.features_6_0_conv1 = nn.Conv2d(512, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_0_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_0_relu1 = nn.ReLU()
        self.features_6_0_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (2, 2), padding = (1, 1), bias = False)
        self.features_6_0_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_0_relu2 = nn.ReLU()
        self.features_6_0_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_0_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_0_downsample_0 = nn.Conv2d(512, 1024, kernel_size = [1, 1], stride = (2, 2), bias = False)
        self.features_6_0_downsample_1 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_0_id_relu = nn.ReLU()
        self.features_6_1_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_1_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_1_relu1 = nn.ReLU()
        self.features_6_1_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_1_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_1_relu2 = nn.ReLU()
        self.features_6_1_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_1_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_1_id_relu = nn.ReLU()
        self.features_6_2_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_2_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_2_relu1 = nn.ReLU()
        self.features_6_2_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_2_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_2_relu2 = nn.ReLU()
        self.features_6_2_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_2_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_2_id_relu = nn.ReLU()
        self.features_6_3_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_3_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_3_relu1 = nn.ReLU()
        self.features_6_3_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_3_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_3_relu2 = nn.ReLU()
        self.features_6_3_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_3_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_3_id_relu = nn.ReLU()
        self.features_6_4_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_4_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_4_relu1 = nn.ReLU()
        self.features_6_4_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_4_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_4_relu2 = nn.ReLU()
        self.features_6_4_conv3 = nn.Conv2d(256, 1024, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_6_4_bn3 = nn.BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True)
        self.features_6_4_id_relu = nn.ReLU()
        self.features_6_5_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_5_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_5_relu1 = nn.ReLU()
        self.features_6_5_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_5_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_5_relu2 = nn.ReLU()
        self.features_6_5_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_5_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_5_id_relu = nn.ReLU()
        self.features_6_6_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_6_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_6_relu1 = nn.ReLU()
        self.features_6_6_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_6_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_6_relu2 = nn.ReLU()
        self.features_6_6_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_6_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_6_id_relu = nn.ReLU()
        self.features_6_7_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_7_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_7_relu1 = nn.ReLU()
        self.features_6_7_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_7_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_7_relu2 = nn.ReLU()
        self.features_6_7_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_7_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_7_id_relu = nn.ReLU()
        self.features_6_8_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_8_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_8_relu1 = nn.ReLU()
        self.features_6_8_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_8_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_8_relu2 = nn.ReLU()
        self.features_6_8_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_8_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_8_id_relu = nn.ReLU()
        self.features_6_9_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_9_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_9_relu1 = nn.ReLU()
        self.features_6_9_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_9_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_9_relu2 = nn.ReLU()
        self.features_6_9_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_9_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_9_id_relu = nn.ReLU()
        self.features_6_10_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_10_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_10_relu1 = nn.ReLU()
        self.features_6_10_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_10_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_10_relu2 = nn.ReLU()
        self.features_6_10_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_10_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_10_id_relu = nn.ReLU()
        self.features_6_11_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_11_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_11_relu1 = nn.ReLU()
        self.features_6_11_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_11_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_11_relu2 = nn.ReLU()
        self.features_6_11_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_11_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_11_id_relu = nn.ReLU()
        self.features_6_12_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_12_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_12_relu1 = nn.ReLU()
        self.features_6_12_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_12_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_12_relu2 = nn.ReLU()
        self.features_6_12_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_12_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_12_id_relu = nn.ReLU()
        self.features_6_13_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_13_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_13_relu1 = nn.ReLU()
        self.features_6_13_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_13_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_13_relu2 = nn.ReLU()
        self.features_6_13_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_13_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_13_id_relu = nn.ReLU()
        self.features_6_14_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_14_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_14_relu1 = nn.ReLU()
        self.features_6_14_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_14_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_14_relu2 = nn.ReLU()
        self.features_6_14_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_14_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_14_id_relu = nn.ReLU()
        self.features_6_15_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_15_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_15_relu1 = nn.ReLU()
        self.features_6_15_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_15_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_15_relu2 = nn.ReLU()
        self.features_6_15_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_15_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_15_id_relu = nn.ReLU()
        self.features_6_16_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_16_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_16_relu1 = nn.ReLU()
        self.features_6_16_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_16_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_16_relu2 = nn.ReLU()
        self.features_6_16_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_16_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_16_id_relu = nn.ReLU()
        self.features_6_17_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_17_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_17_relu1 = nn.ReLU()
        self.features_6_17_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_17_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_17_relu2 = nn.ReLU()
        self.features_6_17_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_17_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_17_id_relu = nn.ReLU()
        self.features_6_18_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_18_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_18_relu1 = nn.ReLU()
        self.features_6_18_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_18_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_18_relu2 = nn.ReLU()
        self.features_6_18_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_18_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_18_id_relu = nn.ReLU()
        self.features_6_19_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_19_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_19_relu1 = nn.ReLU()
        self.features_6_19_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_19_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_19_relu2 = nn.ReLU()
        self.features_6_19_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_19_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_19_id_relu = nn.ReLU()
        self.features_6_20_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_20_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_20_relu1 = nn.ReLU()
        self.features_6_20_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_20_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_20_relu2 = nn.ReLU()
        self.features_6_20_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_20_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_20_id_relu = nn.ReLU()
        self.features_6_21_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_21_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_21_relu1 = nn.ReLU()
        self.features_6_21_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_21_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_21_relu2 = nn.ReLU()
        self.features_6_21_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_21_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_21_id_relu = nn.ReLU()
        self.features_6_22_conv1 = nn.Conv2d(1024, 256, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_22_bn1 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_22_relu1 = nn.ReLU()
        self.features_6_22_conv2 = nn.Conv2d(256, 256, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_6_22_bn2 = nn.BatchNorm2d(256, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_22_relu2 = nn.ReLU()
        self.features_6_22_conv3 = nn.Conv2d(256, 1024, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_6_22_bn3 = nn.BatchNorm2d(1024, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_6_22_id_relu = nn.ReLU()

        self.features_7_0_conv1 = nn.Conv2d(1024, 512, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_7_0_bn1 = nn.BatchNorm2d(512, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_7_0_relu1 = nn.ReLU()
        self.features_7_0_conv2 = nn.Conv2d(512, 512, kernel_size = [3, 3], stride = (2, 2), padding = (1, 1), bias = False)
        self.features_7_0_bn2 = nn.BatchNorm2d(512, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_7_0_relu2 = nn.ReLU()
        self.features_7_0_conv3 = nn.Conv2d(512, 2048, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_7_0_bn3 = nn.BatchNorm2d(2048, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_7_0_downsample_0 = nn.Conv2d(1024, 2048, kernel_size = [1, 1], stride = (2, 2), bias = False)
        self.features_7_0_downsample_1 = nn.BatchNorm2d(2048, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_7_0_id_relu = nn.ReLU()
        self.features_7_1_conv1 = nn.Conv2d(2048, 512, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_7_1_bn1 = nn.BatchNorm2d(512, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_7_1_relu1 = nn.ReLU()
        self.features_7_1_conv2 = nn.Conv2d(512, 512, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_7_1_bn2 = nn.BatchNorm2d(512, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_7_1_relu2 = nn.ReLU()
        self.features_7_1_conv3 = nn.Conv2d(512, 2048, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_7_1_bn3 = nn.BatchNorm2d(2048, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_7_1_id_relu = nn.ReLU()
        self.features_7_2_conv1 = nn.Conv2d(2048, 512, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_7_2_bn1 = nn.BatchNorm2d(512, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_7_2_relu1 = nn.ReLU()
        self.features_7_2_conv2 = nn.Conv2d(512, 512, kernel_size = [3, 3], stride = (1, 1), padding = (1, 1), bias = False)
        self.features_7_2_bn2 = nn.BatchNorm2d(512, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_7_2_relu2 = nn.ReLU()
        self.features_7_2_conv3 = nn.Conv2d(512, 2048, kernel_size = [1, 1], stride = (1, 1), bias = False)
        self.features_7_2_bn3 = nn.BatchNorm2d(2048, eps = 1e-05, momentum = 0.1, affine = True)
        self.features_7_2_id_relu = nn.ReLU()

        self.features_8 = nn.AvgPool2d(kernel_size = [7, 7], stride = [1, 1], padding = 0, ceil_mode = False, count_include_pad = False)

        self.classifier_0 = nn.Linear(in_features = 2048, out_features = 1000, bias = True)


    def forward(self, data):
        features_0 = self.features_0(data)
        features_1 = self.features_1(features_0)
        features_2 = self.features_2(features_1)
        features_3 = self.features_3(features_2)
        features_4_0_conv1 = self.features_4_0_conv1(features_3)
        features_4_0_bn1 = self.features_4_0_bn1(features_4_0_conv1)
        features_4_0_relu1 = self.features_4_0_relu1(features_4_0_bn1)
        features_4_0_conv2 = self.features_4_0_conv2(features_4_0_relu1)
        features_4_0_bn2 = self.features_4_0_bn2(features_4_0_conv2)
        features_4_0_relu2 = self.features_4_0_relu2(features_4_0_bn2)
        features_4_0_conv3 = self.features_4_0_conv3(features_4_0_relu2)
        features_4_0_bn3 = self.features_4_0_bn3(features_4_0_conv3)
        features_4_0_downsample_0 = self.features_4_0_downsample_0(features_3)
        features_4_0_downsample_1 = self.features_4_0_downsample_1(features_4_0_downsample_0)
        features_4_0_merge = torch.add(features_4_0_downsample_1, features_4_0_bn3, alpha = 1)
        features_4_0_id_relu = self.features_4_0_id_relu(features_4_0_merge)
        features_4_1_conv1 = self.features_4_1_conv1(features_4_0_id_relu)
        features_4_1_bn1 = self.features_4_1_bn1(features_4_1_conv1)
        features_4_1_relu1 = self.features_4_1_relu1(features_4_1_bn1)
        features_4_1_conv2 = self.features_4_1_conv2(features_4_1_relu1)
        features_4_1_bn2 = self.features_4_1_bn2(features_4_1_conv2)
        features_4_1_relu2 = self.features_4_1_relu2(features_4_1_bn2)
        features_4_1_conv3 = self.features_4_1_conv3(features_4_1_relu2)
        features_4_1_bn3 = self.features_4_1_bn3(features_4_1_conv3)
        features_4_1_merge = torch.add(features_4_0_id_relu, features_4_1_bn3, alpha = 1)
        features_4_1_id_relu = self.features_4_1_id_relu(features_4_1_merge)
        features_4_2_conv1 = self.features_4_2_conv1(features_4_1_id_relu)
        features_4_2_bn1 = self.features_4_2_bn1(features_4_2_conv1)
        features_4_2_relu1 = self.features_4_2_relu1(features_4_2_bn1)
        features_4_2_conv2 = self.features_4_2_conv2(features_4_2_relu1)
        features_4_2_bn2 = self.features_4_2_bn2(features_4_2_conv2)
        features_4_2_relu2 = self.features_4_2_relu2(features_4_2_bn2)
        features_4_2_conv3 = self.features_4_2_conv3(features_4_2_relu2)
        features_4_2_bn3 = self.features_4_2_bn3(features_4_2_conv3)
        features_4_2_merge = torch.add(features_4_1_id_relu, features_4_2_bn3, alpha = 1)
        features_4_2_id_relu = self.features_4_2_id_relu(features_4_2_merge)
        features_5_0_conv1 = self.features_5_0_conv1(features_4_2_id_relu)
        features_5_0_bn1 = self.features_5_0_bn1(features_5_0_conv1)
        features_5_0_relu1 = self.features_5_0_relu1(features_5_0_bn1)
        features_5_0_conv2 = self.features_5_0_conv2(features_5_0_relu1)
        features_5_0_bn2 = self.features_5_0_bn2(features_5_0_conv2)
        features_5_0_relu2 = self.features_5_0_relu2(features_5_0_bn2)
        features_5_0_conv3 = self.features_5_0_conv3(features_5_0_relu2)
        features_5_0_bn3 = self.features_5_0_bn3(features_5_0_conv3)
        features_5_0_downsample_0 = self.features_5_0_downsample_0(features_4_2_id_relu)
        features_5_0_downsample_1 = self.features_5_0_downsample_1(features_5_0_downsample_0)
        features_5_0_merge = torch.add(features_5_0_downsample_1, features_5_0_bn3, alpha = 1)
        features_5_0_id_relu = self.features_5_0_id_relu(features_5_0_merge)
        features_5_1_conv1 = self.features_5_1_conv1(features_5_0_id_relu)
        features_5_1_bn1 = self.features_5_1_bn1(features_5_1_conv1)
        features_5_1_relu1 = self.features_5_1_relu1(features_5_1_bn1)
        features_5_1_conv2 = self.features_5_1_conv2(features_5_1_relu1)
        features_5_1_bn2 = self.features_5_1_bn2(features_5_1_conv2)
        features_5_1_relu2 = self.features_5_1_relu2(features_5_1_bn2)
        features_5_1_conv3 = self.features_5_1_conv3(features_5_1_relu2)
        features_5_1_bn3 = self.features_5_1_bn3(features_5_1_conv3)
        features_5_1_merge = torch.add(features_5_0_id_relu, features_5_1_bn3, alpha = 1)
        features_5_1_id_relu = self.features_5_1_id_relu(features_5_1_merge)
        features_5_2_conv1 = self.features_5_2_conv1(features_5_1_id_relu)
        features_5_2_bn1 = self.features_5_2_bn1(features_5_2_conv1)
        features_5_2_relu1 = self.features_5_2_relu1(features_5_2_bn1)
        features_5_2_conv2 = self.features_5_2_conv2(features_5_2_relu1)
        features_5_2_bn2 = self.features_5_2_bn2(features_5_2_conv2)
        features_5_2_relu2 = self.features_5_2_relu2(features_5_2_bn2)
        features_5_2_conv3 = self.features_5_2_conv3(features_5_2_relu2)
        features_5_2_bn3 = self.features_5_2_bn3(features_5_2_conv3)
        features_5_2_merge = torch.add(features_5_1_id_relu, features_5_2_bn3, alpha = 1)
        features_5_2_id_relu = self.features_5_2_id_relu(features_5_2_merge)
        features_5_3_conv1 = self.features_5_3_conv1(features_5_2_id_relu)
        features_5_3_bn1 = self.features_5_3_bn1(features_5_3_conv1)
        features_5_3_relu1 = self.features_5_3_relu1(features_5_3_bn1)
        features_5_3_conv2 = self.features_5_3_conv2(features_5_3_relu1)
        features_5_3_bn2 = self.features_5_3_bn2(features_5_3_conv2)
        features_5_3_relu2 = self.features_5_3_relu2(features_5_3_bn2)
        features_5_3_conv3 = self.features_5_3_conv3(features_5_3_relu2)
        features_5_3_bn3 = self.features_5_3_bn3(features_5_3_conv3)
        features_5_3_merge = torch.add(features_5_2_id_relu, features_5_3_bn3, alpha = 1)
        features_5_3_id_relu = self.features_5_3_id_relu(features_5_3_merge)
        features_6_0_conv1 = self.features_6_0_conv1(features_5_3_id_relu)
        features_6_0_bn1 = self.features_6_0_bn1(features_6_0_conv1)
        features_6_0_relu1 = self.features_6_0_relu1(features_6_0_bn1)
        features_6_0_conv2 = self.features_6_0_conv2(features_6_0_relu1)
        features_6_0_bn2 = self.features_6_0_bn2(features_6_0_conv2)
        features_6_0_relu2 = self.features_6_0_relu2(features_6_0_bn2)
        features_6_0_conv3 = self.features_6_0_conv3(features_6_0_relu2)
        features_6_0_bn3 = self.features_6_0_bn3(features_6_0_conv3)
        features_6_0_downsample_0 = self.features_6_0_downsample_0(features_5_3_id_relu)
        features_6_0_downsample_1 = self.features_6_0_downsample_1(features_6_0_downsample_0)
        features_6_0_merge = torch.add(features_6_0_downsample_1, features_6_0_bn3, alpha = 1)
        features_6_0_id_relu = self.features_6_0_id_relu(features_6_0_merge)
        features_6_1_conv1 = self.features_6_1_conv1(features_6_0_id_relu)
        features_6_1_bn1 = self.features_6_1_bn1(features_6_1_conv1)
        features_6_1_relu1 = self.features_6_1_relu1(features_6_1_bn1)
        features_6_1_conv2 = self.features_6_1_conv2(features_6_1_relu1)
        features_6_1_bn2 = self.features_6_1_bn2(features_6_1_conv2)
        features_6_1_relu2 = self.features_6_1_relu2(features_6_1_bn2)
        features_6_1_conv3 = self.features_6_1_conv3(features_6_1_relu2)
        features_6_1_bn3 = self.features_6_1_bn3(features_6_1_conv3)
        features_6_1_merge = torch.add(features_6_0_id_relu, features_6_1_bn3, alpha = 1)
        features_6_1_id_relu = self.features_6_1_id_relu(features_6_1_merge)
        features_6_2_conv1 = self.features_6_2_conv1(features_6_1_id_relu)
        features_6_2_bn1 = self.features_6_2_bn1(features_6_2_conv1)
        features_6_2_relu1 = self.features_6_2_relu1(features_6_2_bn1)
        features_6_2_conv2 = self.features_6_2_conv2(features_6_2_relu1)
        features_6_2_bn2 = self.features_6_2_bn2(features_6_2_conv2)
        features_6_2_relu2 = self.features_6_2_relu2(features_6_2_bn2)
        features_6_2_conv3 = self.features_6_2_conv3(features_6_2_relu2)
        features_6_2_bn3 = self.features_6_2_bn3(features_6_2_conv3)
        features_6_2_merge = torch.add(features_6_1_id_relu, features_6_2_bn3, alpha = 1)
        features_6_2_id_relu = self.features_6_2_id_relu(features_6_2_merge)
        features_6_3_conv1 = self.features_6_3_conv1(features_6_2_id_relu)
        features_6_3_bn1 = self.features_6_3_bn1(features_6_3_conv1)
        features_6_3_relu1 = self.features_6_3_relu1(features_6_3_bn1)
        features_6_3_conv2 = self.features_6_3_conv2(features_6_3_relu1)
        features_6_3_bn2 = self.features_6_3_bn2(features_6_3_conv2)
        features_6_3_relu2 = self.features_6_3_relu2(features_6_3_bn2)
        features_6_3_conv3 = self.features_6_3_conv3(features_6_3_relu2)
        features_6_3_bn3 = self.features_6_3_bn3(features_6_3_conv3)
        features_6_3_merge = torch.add(features_6_2_id_relu, features_6_3_bn3, alpha = 1)
        features_6_3_id_relu = self.features_6_3_id_relu(features_6_3_merge)
        features_6_4_conv1 = self.features_6_4_conv1(features_6_3_id_relu)
        features_6_4_bn1 = self.features_6_4_bn1(features_6_4_conv1)
        features_6_4_relu1 = self.features_6_4_relu1(features_6_4_bn1)
        features_6_4_conv2 = self.features_6_4_conv2(features_6_4_relu1)
        features_6_4_bn2 = self.features_6_4_bn2(features_6_4_conv2)
        features_6_4_relu2 = self.features_6_4_relu2(features_6_4_bn2)
        features_6_4_conv3 = self.features_6_4_conv3(features_6_4_relu2)
        features_6_4_bn3 = self.features_6_4_bn3(features_6_4_conv3)
        features_6_4_merge = torch.add(features_6_3_id_relu, features_6_4_bn3, alpha = 1)
        features_6_4_id_relu = self.features_6_4_id_relu(features_6_4_merge)
        features_6_5_conv1 = self.features_6_5_conv1(features_6_4_id_relu)
        features_6_5_bn1 = self.features_6_5_bn1(features_6_5_conv1)
        features_6_5_relu1 = self.features_6_5_relu1(features_6_5_bn1)
        features_6_5_conv2 = self.features_6_5_conv2(features_6_5_relu1)
        features_6_5_bn2 = self.features_6_5_bn2(features_6_5_conv2)
        features_6_5_relu2 = self.features_6_5_relu2(features_6_5_bn2)
        features_6_5_conv3 = self.features_6_5_conv3(features_6_5_relu2)
        features_6_5_bn3 = self.features_6_5_bn3(features_6_5_conv3)
        features_6_5_merge = torch.add(features_6_4_id_relu, features_6_5_bn3, alpha = 1)
        features_6_5_id_relu = self.features_6_5_id_relu(features_6_5_merge)
        features_6_6_conv1 = self.features_6_6_conv1(features_6_5_id_relu)
        features_6_6_bn1 = self.features_6_6_bn1(features_6_6_conv1)
        features_6_6_relu1 = self.features_6_6_relu1(features_6_6_bn1)
        features_6_6_conv2 = self.features_6_6_conv2(features_6_6_relu1)
        features_6_6_bn2 = self.features_6_6_bn2(features_6_6_conv2)
        features_6_6_relu2 = self.features_6_6_relu2(features_6_6_bn2)
        features_6_6_conv3 = self.features_6_6_conv3(features_6_6_relu2)
        features_6_6_bn3 = self.features_6_6_bn3(features_6_6_conv3)
        features_6_6_merge = torch.add(features_6_5_id_relu, features_6_6_bn3, alpha = 1)
        features_6_6_id_relu = self.features_6_6_id_relu(features_6_6_merge)
        features_6_7_conv1 = self.features_6_7_conv1(features_6_6_id_relu)
        features_6_7_bn1 = self.features_6_7_bn1(features_6_7_conv1)
        features_6_7_relu1 = self.features_6_7_relu1(features_6_7_bn1)
        features_6_7_conv2 = self.features_6_7_conv2(features_6_7_relu1)
        features_6_7_bn2 = self.features_6_7_bn2(features_6_7_conv2)
        features_6_7_relu2 = self.features_6_7_relu2(features_6_7_bn2)
        features_6_7_conv3 = self.features_6_7_conv3(features_6_7_relu2)
        features_6_7_bn3 = self.features_6_7_bn3(features_6_7_conv3)
        features_6_7_merge = torch.add(features_6_6_id_relu, features_6_7_bn3, alpha = 1)
        features_6_7_id_relu = self.features_6_7_id_relu(features_6_7_merge)
        features_6_8_conv1 = self.features_6_8_conv1(features_6_7_id_relu)
        features_6_8_bn1 = self.features_6_8_bn1(features_6_8_conv1)
        features_6_8_relu1 = self.features_6_8_relu1(features_6_8_bn1)
        features_6_8_conv2 = self.features_6_8_conv2(features_6_8_relu1)
        features_6_8_bn2 = self.features_6_8_bn2(features_6_8_conv2)
        features_6_8_relu2 = self.features_6_8_relu2(features_6_8_bn2)
        features_6_8_conv3 = self.features_6_8_conv3(features_6_8_relu2)
        features_6_8_bn3 = self.features_6_8_bn3(features_6_8_conv3)
        features_6_8_merge = torch.add(features_6_7_id_relu, features_6_8_bn3, alpha = 1)
        features_6_8_id_relu = self.features_6_8_id_relu(features_6_8_merge)
        features_6_9_conv1 = self.features_6_9_conv1(features_6_8_id_relu)
        features_6_9_bn1 = self.features_6_9_bn1(features_6_9_conv1)
        features_6_9_relu1 = self.features_6_9_relu1(features_6_9_bn1)
        features_6_9_conv2 = self.features_6_9_conv2(features_6_9_relu1)
        features_6_9_bn2 = self.features_6_9_bn2(features_6_9_conv2)
        features_6_9_relu2 = self.features_6_9_relu2(features_6_9_bn2)
        features_6_9_conv3 = self.features_6_9_conv3(features_6_9_relu2)
        features_6_9_bn3 = self.features_6_9_bn3(features_6_9_conv3)
        features_6_9_merge = torch.add(features_6_8_id_relu, features_6_9_bn3, alpha = 1)
        features_6_9_id_relu = self.features_6_9_id_relu(features_6_9_merge)
        features_6_10_conv1 = self.features_6_10_conv1(features_6_9_id_relu)
        features_6_10_bn1 = self.features_6_10_bn1(features_6_10_conv1)
        features_6_10_relu1 = self.features_6_10_relu1(features_6_10_bn1)
        features_6_10_conv2 = self.features_6_10_conv2(features_6_10_relu1)
        features_6_10_bn2 = self.features_6_10_bn2(features_6_10_conv2)
        features_6_10_relu2 = self.features_6_10_relu2(features_6_10_bn2)
        features_6_10_conv3 = self.features_6_10_conv3(features_6_10_relu2)
        features_6_10_bn3 = self.features_6_10_bn3(features_6_10_conv3)
        features_6_10_merge = torch.add(features_6_9_id_relu, features_6_10_bn3, alpha = 1)
        features_6_10_id_relu = self.features_6_10_id_relu(features_6_10_merge)
        features_6_11_conv1 = self.features_6_11_conv1(features_6_10_id_relu)
        features_6_11_bn1 = self.features_6_11_bn1(features_6_11_conv1)
        features_6_11_relu1 = self.features_6_11_relu1(features_6_11_bn1)
        features_6_11_conv2 = self.features_6_11_conv2(features_6_11_relu1)
        features_6_11_bn2 = self.features_6_11_bn2(features_6_11_conv2)
        features_6_11_relu2 = self.features_6_11_relu2(features_6_11_bn2)
        features_6_11_conv3 = self.features_6_11_conv3(features_6_11_relu2)
        features_6_11_bn3 = self.features_6_11_bn3(features_6_11_conv3)
        features_6_11_merge = torch.add(features_6_10_id_relu, features_6_11_bn3, alpha = 1)
        features_6_11_id_relu = self.features_6_11_id_relu(features_6_11_merge)
        features_6_12_conv1 = self.features_6_12_conv1(features_6_11_id_relu)
        features_6_12_bn1 = self.features_6_12_bn1(features_6_12_conv1)
        features_6_12_relu1 = self.features_6_12_relu1(features_6_12_bn1)
        features_6_12_conv2 = self.features_6_12_conv2(features_6_12_relu1)
        features_6_12_bn2 = self.features_6_12_bn2(features_6_12_conv2)
        features_6_12_relu2 = self.features_6_12_relu2(features_6_12_bn2)
        features_6_12_conv3 = self.features_6_12_conv3(features_6_12_relu2)
        features_6_12_bn3 = self.features_6_12_bn3(features_6_12_conv3)
        features_6_12_merge = torch.add(features_6_11_id_relu, features_6_12_bn3, alpha = 1)
        features_6_12_id_relu = self.features_6_12_id_relu(features_6_12_merge)
        features_6_13_conv1 = self.features_6_13_conv1(features_6_12_id_relu)
        features_6_13_bn1 = self.features_6_13_bn1(features_6_13_conv1)
        features_6_13_relu1 = self.features_6_13_relu1(features_6_13_bn1)
        features_6_13_conv2 = self.features_6_13_conv2(features_6_13_relu1)
        features_6_13_bn2 = self.features_6_13_bn2(features_6_13_conv2)
        features_6_13_relu2 = self.features_6_13_relu2(features_6_13_bn2)
        features_6_13_conv3 = self.features_6_13_conv3(features_6_13_relu2)
        features_6_13_bn3 = self.features_6_13_bn3(features_6_13_conv3)
        features_6_13_merge = torch.add(features_6_12_id_relu, features_6_13_bn3, alpha = 1)
        features_6_13_id_relu = self.features_6_13_id_relu(features_6_13_merge)
        features_6_14_conv1 = self.features_6_14_conv1(features_6_13_id_relu)
        features_6_14_bn1 = self.features_6_14_bn1(features_6_14_conv1)
        features_6_14_relu1 = self.features_6_14_relu1(features_6_14_bn1)
        features_6_14_conv2 = self.features_6_14_conv2(features_6_14_relu1)
        features_6_14_bn2 = self.features_6_14_bn2(features_6_14_conv2)
        features_6_14_relu2 = self.features_6_14_relu2(features_6_14_bn2)
        features_6_14_conv3 = self.features_6_14_conv3(features_6_14_relu2)
        features_6_14_bn3 = self.features_6_14_bn3(features_6_14_conv3)
        features_6_14_merge = torch.add(features_6_13_id_relu, features_6_14_bn3, alpha = 1)
        features_6_14_id_relu = self.features_6_14_id_relu(features_6_14_merge)
        features_6_15_conv1 = self.features_6_15_conv1(features_6_14_id_relu)
        features_6_15_bn1 = self.features_6_15_bn1(features_6_15_conv1)
        features_6_15_relu1 = self.features_6_15_relu1(features_6_15_bn1)
        features_6_15_conv2 = self.features_6_15_conv2(features_6_15_relu1)
        features_6_15_bn2 = self.features_6_15_bn2(features_6_15_conv2)
        features_6_15_relu2 = self.features_6_15_relu2(features_6_15_bn2)
        features_6_15_conv3 = self.features_6_15_conv3(features_6_15_relu2)
        features_6_15_bn3 = self.features_6_15_bn3(features_6_15_conv3)
        features_6_15_merge = torch.add(features_6_14_id_relu, features_6_15_bn3, alpha = 1)
        features_6_15_id_relu = self.features_6_15_id_relu(features_6_15_merge)
        features_6_16_conv1 = self.features_6_16_conv1(features_6_15_id_relu)
        features_6_16_bn1 = self.features_6_16_bn1(features_6_16_conv1)
        features_6_16_relu1 = self.features_6_16_relu1(features_6_16_bn1)
        features_6_16_conv2 = self.features_6_16_conv2(features_6_16_relu1)
        features_6_16_bn2 = self.features_6_16_bn2(features_6_16_conv2)
        features_6_16_relu2 = self.features_6_16_relu2(features_6_16_bn2)
        features_6_16_conv3 = self.features_6_16_conv3(features_6_16_relu2)
        features_6_16_bn3 = self.features_6_16_bn3(features_6_16_conv3)
        features_6_16_merge = torch.add(features_6_15_id_relu, features_6_16_bn3, alpha = 1)
        features_6_16_id_relu = self.features_6_16_id_relu(features_6_16_merge)
        features_6_17_conv1 = self.features_6_17_conv1(features_6_16_id_relu)
        features_6_17_bn1 = self.features_6_17_bn1(features_6_17_conv1)
        features_6_17_relu1 = self.features_6_17_relu1(features_6_17_bn1)
        features_6_17_conv2 = self.features_6_17_conv2(features_6_17_relu1)
        features_6_17_bn2 = self.features_6_17_bn2(features_6_17_conv2)
        features_6_17_relu2 = self.features_6_17_relu2(features_6_17_bn2)
        features_6_17_conv3 = self.features_6_17_conv3(features_6_17_relu2)
        features_6_17_bn3 = self.features_6_17_bn3(features_6_17_conv3)
        features_6_17_merge = torch.add(features_6_16_id_relu, features_6_17_bn3, alpha = 1)
        features_6_17_id_relu = self.features_6_17_id_relu(features_6_17_merge)
        features_6_18_conv1 = self.features_6_18_conv1(features_6_17_id_relu)
        features_6_18_bn1 = self.features_6_18_bn1(features_6_18_conv1)
        features_6_18_relu1 = self.features_6_18_relu1(features_6_18_bn1)
        features_6_18_conv2 = self.features_6_18_conv2(features_6_18_relu1)
        features_6_18_bn2 = self.features_6_18_bn2(features_6_18_conv2)
        features_6_18_relu2 = self.features_6_18_relu2(features_6_18_bn2)
        features_6_18_conv3 = self.features_6_18_conv3(features_6_18_relu2)
        features_6_18_bn3 = self.features_6_18_bn3(features_6_18_conv3)
        features_6_18_merge = torch.add(features_6_17_id_relu, features_6_18_bn3, alpha = 1)
        features_6_18_id_relu = self.features_6_18_id_relu(features_6_18_merge)
        features_6_19_conv1 = self.features_6_19_conv1(features_6_18_id_relu)
        features_6_19_bn1 = self.features_6_19_bn1(features_6_19_conv1)
        features_6_19_relu1 = self.features_6_19_relu1(features_6_19_bn1)
        features_6_19_conv2 = self.features_6_19_conv2(features_6_19_relu1)
        features_6_19_bn2 = self.features_6_19_bn2(features_6_19_conv2)
        features_6_19_relu2 = self.features_6_19_relu2(features_6_19_bn2)
        features_6_19_conv3 = self.features_6_19_conv3(features_6_19_relu2)
        features_6_19_bn3 = self.features_6_19_bn3(features_6_19_conv3)
        features_6_19_merge = torch.add(features_6_18_id_relu, features_6_19_bn3, alpha = 1)
        features_6_19_id_relu = self.features_6_19_id_relu(features_6_19_merge)
        features_6_20_conv1 = self.features_6_20_conv1(features_6_19_id_relu)
        features_6_20_bn1 = self.features_6_20_bn1(features_6_20_conv1)
        features_6_20_relu1 = self.features_6_20_relu1(features_6_20_bn1)
        features_6_20_conv2 = self.features_6_20_conv2(features_6_20_relu1)
        features_6_20_bn2 = self.features_6_20_bn2(features_6_20_conv2)
        features_6_20_relu2 = self.features_6_20_relu2(features_6_20_bn2)
        features_6_20_conv3 = self.features_6_20_conv3(features_6_20_relu2)
        features_6_20_bn3 = self.features_6_20_bn3(features_6_20_conv3)
        features_6_20_merge = torch.add(features_6_19_id_relu, features_6_20_bn3, alpha = 1)
        features_6_20_id_relu = self.features_6_20_id_relu(features_6_20_merge)
        features_6_21_conv1 = self.features_6_21_conv1(features_6_20_id_relu)
        features_6_21_bn1 = self.features_6_21_bn1(features_6_21_conv1)
        features_6_21_relu1 = self.features_6_21_relu1(features_6_21_bn1)
        features_6_21_conv2 = self.features_6_21_conv2(features_6_21_relu1)
        features_6_21_bn2 = self.features_6_21_bn2(features_6_21_conv2)
        features_6_21_relu2 = self.features_6_21_relu2(features_6_21_bn2)
        features_6_21_conv3 = self.features_6_21_conv3(features_6_21_relu2)
        features_6_21_bn3 = self.features_6_21_bn3(features_6_21_conv3)
        features_6_21_merge = torch.add(features_6_20_id_relu, features_6_21_bn3, alpha = 1)
        features_6_21_id_relu = self.features_6_21_id_relu(features_6_21_merge)
        features_6_22_conv1 = self.features_6_22_conv1(features_6_21_id_relu)
        features_6_22_bn1 = self.features_6_22_bn1(features_6_22_conv1)
        features_6_22_relu1 = self.features_6_22_relu1(features_6_22_bn1)
        features_6_22_conv2 = self.features_6_22_conv2(features_6_22_relu1)
        features_6_22_bn2 = self.features_6_22_bn2(features_6_22_conv2)
        features_6_22_relu2 = self.features_6_22_relu2(features_6_22_bn2)
        features_6_22_conv3 = self.features_6_22_conv3(features_6_22_relu2)
        features_6_22_bn3 = self.features_6_22_bn3(features_6_22_conv3)
        features_6_22_merge = torch.add(features_6_21_id_relu, features_6_22_bn3, alpha = 1)
        features_6_22_id_relu = self.features_6_22_id_relu(features_6_22_merge)
        features_7_0_conv1 = self.features_7_0_conv1(features_6_22_id_relu)
        features_7_0_bn1 = self.features_7_0_bn1(features_7_0_conv1)
        features_7_0_relu1 = self.features_7_0_relu1(features_7_0_bn1)
        features_7_0_conv2 = self.features_7_0_conv2(features_7_0_relu1)
        features_7_0_bn2 = self.features_7_0_bn2(features_7_0_conv2)
        features_7_0_relu2 = self.features_7_0_relu2(features_7_0_bn2)
        features_7_0_conv3 = self.features_7_0_conv3(features_7_0_relu2)
        features_7_0_bn3 = self.features_7_0_bn3(features_7_0_conv3)
        features_7_0_downsample_0 = self.features_7_0_downsample_0(features_6_22_id_relu)
        features_7_0_downsample_1 = self.features_7_0_downsample_1(features_7_0_downsample_0)
        features_7_0_merge = torch.add(features_7_0_downsample_1, features_7_0_bn3, alpha = 1)
        features_7_0_id_relu = self.features_7_0_id_relu(features_7_0_merge)
        features_7_1_conv1 = self.features_7_1_conv1(features_7_0_id_relu)
        features_7_1_bn1 = self.features_7_1_bn1(features_7_1_conv1)
        features_7_1_relu1 = self.features_7_1_relu1(features_7_1_bn1)
        features_7_1_conv2 = self.features_7_1_conv2(features_7_1_relu1)
        features_7_1_bn2 = self.features_7_1_bn2(features_7_1_conv2)
        features_7_1_relu2 = self.features_7_1_relu2(features_7_1_bn2)
        features_7_1_conv3 = self.features_7_1_conv3(features_7_1_relu2)
        features_7_1_bn3 = self.features_7_1_bn3(features_7_1_conv3)
        features_7_1_merge = torch.add(features_7_0_id_relu, features_7_1_bn3, alpha = 1)
        features_7_1_id_relu = self.features_7_1_id_relu(features_7_1_merge)
        features_7_2_conv1 = self.features_7_2_conv1(features_7_1_id_relu)
        features_7_2_bn1 = self.features_7_2_bn1(features_7_2_conv1)
        features_7_2_relu1 = self.features_7_2_relu1(features_7_2_bn1)
        features_7_2_conv2 = self.features_7_2_conv2(features_7_2_relu1)
        features_7_2_bn2 = self.features_7_2_bn2(features_7_2_conv2)
        features_7_2_relu2 = self.features_7_2_relu2(features_7_2_bn2)
        features_7_2_conv3 = self.features_7_2_conv3(features_7_2_relu2)
        features_7_2_bn3 = self.features_7_2_bn3(features_7_2_conv3)
        features_7_2_merge = torch.add(features_7_1_id_relu, features_7_2_bn3, alpha = 1)
        features_7_2_id_relu = self.features_7_2_id_relu(features_7_2_merge)
        features_8 = self.features_8(features_7_2_id_relu)
        classifier_flatten = features_8.view(features_8.size(0), -1)
        classifier_0 = self.classifier_0(classifier_flatten)

        return classifier_0

